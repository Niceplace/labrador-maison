services:
  app:
    image: fireflyiii/core@sha256:a1f65bf8d1ddb3c6684ab720439b48554eae6ef85c768076b7f495189efc716e
    container_name: firefly-iii
    restart: unless-stopped
    volumes:
      - ./upload:/var/www/html/storage/upload
    env_file:
      - .env
    networks:
      - thinknetwork
    labels:
      - traefik.enable=true
      - traefik.http.routers.firefly.rule=Host(`firefly.thinkcenter.dev`)
      - traefik.http.routers.firefly.entrypoints=websecure
      - traefik.http.services.firefly.loadbalancer.server.port=8080
    depends_on:
      - db
  db:
    image: mariadb@sha256:345fa26d595e8c7fe298e0c4098ed400356f502458769c8902229b3437d6da2b
    container_name: firefly-db
    restart: unless-stopped
    volumes:
      - ./db:/var/lib/mysql
    environment:
      - MYSQL_RANDOM_ROOT_PASSWORD=yes
      - MYSQL_USER=firefly
      - MYSQL_PASSWORD=firefly_password
      - MYSQL_DATABASE=firefly
    networks:
      - thinknetwork
networks:
  thinknetwork:
    external: true
